<div class="selected-product" *ngIf="selectedProduct">
  <ion-icon class="close" (click)="selectedProduct=null" name="close"></ion-icon>
  <img [defaultImage]="default" [lazyLoad]="liveProductPhotoBaseUrl+selectedProduct.photo" />
  <div class="info-container">
    <div class="cart-button">
      <div class="price">€{{' '+(selectedProduct.price? selectedProduct.price:'')}}</div>
      <div class="buttons d-flex">
        <ion-button mode="md" style="height: 36px;" (click)="makePayment()"><ion-icon name="card"></ion-icon>
          Mokėti dabar</ion-button>
        <ion-button mode="md" style="height: 36px;" (click)="addToCart(selectedProduct)"><ion-icon
            name="cart"></ion-icon>
          Į krepšelį</ion-button>
      </div>
    </div>
    <ng-container *ngIf="selectedProduct.colors.length>0 || selectedProduct.sizes.length>0">
      <div class="size-color mt-1 text-center">
        Ismatavimai / spalvos
      </div>
      <div class="color-container mt-1">
        <div class="colors">
          <ion-button mode="md" [attr.selected]="color.selected"
            (click)="onClickColorOrSize(color, selectedProduct.colors)"
            *ngFor="let color of selectedProduct.colors; let i =  index">{{color.name}}</ion-button>
        </div>
      </div>
      <div class="color-container mt-1">
        <div class="colors">
          <ion-button mode="md" [attr.selected]="size.selected"
            (click)="onClickColorOrSize(size, selectedProduct.sizes)"
            *ngFor="let size of selectedProduct.sizes; let i =  index">{{size.name}}</ion-button>
        </div>
      </div>
    </ng-container>
  </div>
  <div class="mobile-price-button">
    <div class="price">€{{' '+(selectedProduct.price||0)}}</div>
    <ion-button mode="md" (click)="onContinue(selectedProduct.id)">Testi Pirkima</ion-button>
  </div>
</div>
<div *ngIf="isGalary;else liveProduct" class="gallery" style="flex: 1;overflow-y: auto;">
  <div class="mobile-product-container">
    <div class="mobile-product" (click)="onProductSelect(product)" *ngFor="let product of allProducts">
      <img class="img-center prod-img" [lazyLoad]="liveProductPhotoBaseUrl+product.photo" />
      <ion-icon *ngIf="menuVisible" (click)="onOptionClick($event, product)" class="edit-icon"
        name="ellipsis-vertical"></ion-icon>
      <div class="pH15">
        <div class="price">
          €{{' '+(product.price||0)}}
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #liveProduct>
  <div class="products-container">
    <div (click)="onProductSelect(product)" *ngFor="let product of liveProducts">
      <ion-icon *ngIf="menuVisible" (click)="onOptionClick($event, product)" class="edit-icon"
        name="ellipsis-vertical"></ion-icon>
      <img [style]="selectedProduct && product.id === selectedProduct.id? 'filter: brightness(0.8);':''"
        [defaultImage]="default" [lazyLoad]="liveProductPhotoBaseUrl+product.photo" />
    </div>
  </div>
</ng-template>
<ion-popover #contextMenu [isOpen]="editableProduct!==null" (didDismiss)="editableProduct=null" mode="ios">
  <ng-template>
    <ion-content style="--padding-top:0px; --padding-start: 0px; --padding-end:0px;--padding-bottom: 0px;"
      [scrollY]="false" class="ion-padding">
      <ion-item (click)="onContextButtonClick(true, editableProduct)" [button]="true">
        <ion-icon color="warning" slot="start" name="pencil" size="large"></ion-icon>
        <ion-label>Edit</ion-label>
      </ion-item>
      <ion-item (click)="onContextButtonClick(false, editableProduct)" [button]="true">
        <ion-icon color="danger" slot="start" name="trash" size="large"></ion-icon>
        <ion-label>Delete</ion-label>
      </ion-item>
    </ion-content>
  </ng-template>
</ion-popover>